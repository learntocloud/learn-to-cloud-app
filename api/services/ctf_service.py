"""CTF Token Verification for Linux CTF Challenge.

This module verifies CTF completion tokens generated by the Linux CTF challenges.
The verification process ensures:
1. Token is properly signed with HMAC
2. GitHub username in the token matches the authenticated user
3. All 18 challenges are completed
4. Timestamp is valid

Shared token verification logic (decoding, HMAC, username matching)
lives in ``services.token_verification_base``.
"""

from schemas import CTFVerificationResult
from services.token_verification_base import LabConfig, verify_lab_token

_CTF_CONFIG = LabConfig(
    required_challenges=18,
    challenge_label="challenges",
    log_prefix="ctf",
    service_display_name="CTF",
    success_message=(
        "ðŸŽ‰ Congratulations! You have completed all 18 " "Linux CTF challenges!"
    ),
)


def verify_ctf_token(token: str, oauth_github_username: str) -> CTFVerificationResult:
    """Verify a CTF completion token."""
    result = verify_lab_token(token, oauth_github_username, _CTF_CONFIG)
    return CTFVerificationResult(**result)
