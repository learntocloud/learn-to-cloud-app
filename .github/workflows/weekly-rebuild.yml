name: Weekly Security Rebuild

# ============================================================
# Security: Rebuild images weekly for OS/dependency updates
# ============================================================
on:
  schedule:
    - cron: '0 6 * * 0'  # Every Sunday at 6 AM UTC
  workflow_dispatch:

jobs:
  rebuild-and-deploy-dev:
    uses: ./.github/workflows/dev-deploy.yml
    secrets: inherit
    with:
      force_rebuild: true

  promote-and-deploy-prod:
    needs: rebuild-and-deploy-dev
    uses: ./.github/workflows/prod-deploy.yml
    secrets: inherit
